<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <title>å¿«æ·æŒ‡ä»¤åˆé›†</title>
  <link rel="icon" href="../files/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="../files/desktop.png">
  <link rel="manifest" href="../files/manifest.json">
  <meta name="theme-color" content="#ffffff">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", sans-serif;
      margin: 0;
      padding: 40px 20px;
      background-color: #f5f5f5;
      color: #1a1a1a;
      display: flex;
      justify-content: center;
      font-size: 66.66%;
    }

    .container {
      max-width: 700px;
      width: 100%;
      background: #ffffff;
      border: 1px solid #e2e2e2;
      border-radius: 10px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      padding: 40px;
    }

    .container img.cover {
      width: 100%;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .top-link {
      margin-bottom: 20px;
      font-size: 0.9em;
      color: #555555;
    }

    .top-link a {
      color: #0070f3;
      text-decoration: none;
    }

    .top-link a:hover {
      text-decoration: underline;
    }

    h1 {
      font-size: 2.2em;
      font-weight: 600;
      margin-bottom: 16px;
      color: #111111;
    }

    .search-box {
      margin-bottom: 24px;
      position: relative;
    }

    .search-box input {
      width: 100%;
      padding: 10px 40px 10px 14px;
      font-size: 1em;
      border: 1px solid #ddd;
      border-radius: 6px;
      box-sizing: border-box;
    }

    #clearBtn {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      cursor: pointer;
      display: none;
      padding: 0;
      line-height: 1;
    }

    #clearBtn svg {
      width: 16px;
      height: 16px;
    }

    #clearBtn svg:hover {
      opacity: 0.8;
    }

    ul {
      list-style: none;
      padding: 0;
      padding-bottom: 300px;
    }

    li {
      border: 1px solid #e2e2e2;
      border-radius: 5px;
      padding: 10px 14px;
      margin-bottom: 8px;
      transition: background-color 0.2s, box-shadow 0.2s;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    li:hover {
      background-color: #fafafa;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }

    .link-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    li a {
      font-size: 1em;
      color: #0070f3;
      text-decoration: none;
      display: inline-block;
    }

    li a:hover {
      text-decoration: underline;
    }

    .stars {
      font-size: 1em;
      color: #f5a623;
      white-space: nowrap;
      margin-left: 8px;
    }

    .update-time {
      font-size: 0.85em;
      color: #888;
      margin-top: 4px;
      position: relative;
      padding-left: 1.9em;
    }

    .clock-icon {
      position: absolute;
      left: 0;
      top: 0;
      user-select: none;
    }

    .author {
      float: right;
    }

    @media (max-width: 600px) {
      .container {
        padding: 24px;
      }
      h1 {
        font-size: 2em;
      }
      li {
        padding: 8px 12px;
      }
    }
    select {
      background-color: #f9f9f9;
    }
    #refreshBtn {
      position: fixed;
      right: 20px;
      bottom: 20px;
      z-index: 9999;
      width: 45px;
      height: 45px;
      border: none;
      border-radius: 50%;
      background-color: rgba(200, 200, 200, 0.6); /* æ·¡è‰²åŠé€æ˜ */
      color: #333;
      font-size: 1.5em;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: background-color 0.2s, transform 0.2s;
      backdrop-filter: blur(5px); /* åŠé€æ˜æ¨¡ç³ŠèƒŒæ™¯ï¼Œæ›´é«˜çº§ */
    }

    #refreshBtn:hover {
      background-color: rgba(150, 150, 150, 0.8);
      transform: scale(1.1);
    }
    /* é®ç½©å±‚è¦†ç›–å…¨å± */
    #loadingOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(255,255,255,0.95); /* åŠé€æ˜ç™½è‰²é®ç½© */
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 1;
      transition: opacity 0.6s ease; /* æ¸éšè¿‡æ¸¡ */
    }

    /* Craft é£æ ¼ç™½è‰²å°åœˆ spinner */
    .spinner {
      width: 24px;               
      height: 24px;
      border: 3px solid rgba(255,255,255,0.3); /* åŠé€æ˜åº•åœˆ */
      border-top: 3px solid #ffffff;           /* ç™½è‰²æ—‹è½¬éƒ¨åˆ† */
      border-radius: 50%;
      animation: spin 1s linear infinite;
      box-sizing: border-box;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* æŸ”å’Œæ·±ä¸€ç‚¹çš„åŠé€æ˜é®ç½©å±‚ */
    #loadingOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0,0,0,0.2); /* ç•¥æ·±ç°ï¼ŒæŸ”å’ŒåŠé€æ˜ */
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 1;
      transition: opacity 0.5s ease;
    }

  </style>
</head>
<body>
  <div id="loadingOverlay">
  <div class="spinner"></div>
</div>
  <div class="container">
    <img class="cover" src="../files/fengmian.JPG" alt="å°é¢å›¾" />

    <div class="top-link">
      ğŸ“Œ æˆ‘çš„é¢‘é“ï¼š<a href="https://t.me/WWWengShare" target="_blank">https://t.me/WWWengShare</a>
        ï½œ  ğŸŒ <a href="Home.html" class="link-text">ä¸»é¡µ</a>
    </div>
    
    <h1 id="pageTitle">å¿«æ·æŒ‡ä»¤åˆé›†</h1>

    <div class="search-box" style="display: flex; gap: 8px; flex-wrap: wrap;">
      <select id="timeFilter" style="flex:1; padding: 8px; font-size: 1em; border-radius: 6px; border: 1px solid #ddd;">
        <option value="desc">ğŸ“‰ æ—¶é—´é™åº</option>
        <option value="asc">ğŸ“ˆ æ—¶é—´å‡åº</option>
        <option value="">ğŸªª åç§°æ’åº</option>
      </select>
      <select id="starFilter" style="flex:1; padding: 8px; font-size: 1em; border-radius: 6px; border: 1px solid #ddd;">
        <option value="">ğŸŒŸ å…¨éƒ¨æ˜Ÿçº§</option>
        <option value="1">â­ 1æ˜ŸåŠä»¥ä¸Š</option>
        <option value="2">â­â­ 2æ˜ŸåŠä»¥ä¸Š</option>
        <option value="3">â­â­â­ 3æ˜Ÿ</option>
      </select>
      <select id="authorFilter" style="flex:1; padding: 8px; font-size: 1em; border-radius: 6px; border: 1px solid #ddd;">
        <option value="">ğŸ¨ å…¨éƒ¨ä½œè€…</option>
      </select>
    </div>

    <div class="search-box">
      <input type="text" id="searchInput" placeholder="ğŸ” æœç´¢å¿«æ·æŒ‡ä»¤å…³é”®è¯..." onkeyup="filterList()" />
      <button id="clearBtn" onclick="clearSearch()" aria-label="æ¸…ç©ºæœç´¢">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none">
          <circle cx="12" cy="12" r="11" fill="#e0e0e0"/>
          <path d="M15 9L9 15M9 9l6 6" stroke="#555" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>

    <ul id="shortcutList"></ul>

    <div id="visitorCounter" style="
      position: fixed;
      bottom: 10px;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 0.9em;
      color: #999;
      background: transparent;
      padding: 6px 0;
      z-index: 999;
      opacity: 1;
      transition: opacity 0.5s;
    ">
      ğŸŒ ç½‘ç«™æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv">åŠ è½½ä¸­...</span>
    </div>

    <script>
      let allShortcuts = [];

      function updateTitleCount(count) {
        const title = document.getElementById("pageTitle");
        title.textContent = `å¿«æ·æŒ‡ä»¤åˆé›†ï¼ˆå…± ${count} ä¸ªï¼‰`;
      }

      function getCurrentFormattedTime() {
        const now = new Date();
        const yy = String(now.getFullYear()).slice(2);
        const mm = String(now.getMonth() + 1).padStart(2, '0');
        const dd = String(now.getDate()).padStart(2, '0');
        const hh = String(now.getHours()).padStart(2, '0');
        const min = String(now.getMinutes()).padStart(2, '0');
        return `${yy}-${mm}-${dd}  ${hh}:${min}`;
      }

      function renderList(shortcuts) {
        const ul = document.getElementById("shortcutList");
        ul.innerHTML = "";

        shortcuts.forEach(item => {
          const li = document.createElement("li");

          const linkRow = document.createElement("div");
          linkRow.className = "link-row";

          const emoji = document.createElement("span");
          emoji.innerHTML = "ğŸ“&nbsp;";
          linkRow.appendChild(emoji);

          const titleWrapper = document.createElement("div");
          titleWrapper.style.flex = "1";
          const a = document.createElement("a");
          let href = item.url || item.name || item.title || '#';
          href = href.replace(/^\/?pages\//, '');
          href = href.startsWith('/') ? href : `/${href}`;
          a.href = href;
          a.textContent = item.title;
          a.target = "_blank";
          a.rel = "noopener noreferrer";
          a.style.display = "inline-block";

          titleWrapper.appendChild(a);
          linkRow.appendChild(titleWrapper);

          if (item.star && item.star > 0) {
            const stars = document.createElement("span");
            stars.className = "stars";
            stars.textContent = "â­".repeat(item.star);
            linkRow.appendChild(stars);
          }

          li.appendChild(linkRow);

          const updateTime = document.createElement("div");
          updateTime.className = "update-time";

          const timeSpan = document.createElement("span");
          timeSpan.innerHTML = `<span class="clock-icon">ğŸ•’</span>Updateï¼š${item.time || getCurrentFormattedTime()}`;
          updateTime.appendChild(timeSpan);

          if (item.author) {
            const authorSpan = document.createElement("span");
            authorSpan.textContent = `Byï¼š${item.author}`;
            authorSpan.className = "author";
            updateTime.appendChild(authorSpan);
          }

          li.appendChild(updateTime);
          ul.appendChild(li);
        });

        if (shortcuts.length > 0) {
          const note = document.createElement("li");
          note.style.marginTop = "20px";
          note.style.padding = "14px";
          note.style.border = "none";
          note.style.fontSize = "0.8em";

          note.innerHTML = `
            <div style="margin-bottom: 10px; text-align: center; font-size: 1.6em;">
              ğŸ  <a href="Home.html" style="color: #0070f3; text-decoration: none;"><strong>è¿”å›ä¸»é¡µ</strong></a>
            </div>
            <div style="margin-bottom: 8px;">
              ğŸ“¢ <strong>æç¤ºï¼š</strong><br><br>â‘ è¯¥é¡µé¢å¿«æ·æŒ‡ä»¤å°†ä¼šè‡ªåŠ¨æ›´æ–°ä¸ºæœ€æ–°ç‰ˆä½¿ç”¨å‰åŠ¡å¿…çœ‹æ¸…æ³¨é‡Šå†…å®¹ï¼Œè‹¥ä¸æ˜ç™½å¯ç»“åˆé¢‘é“çš„è§†é¢‘ä¸€èµ·çœ‹ï¼›<br><br>â‘¡â­è¡¨ç¤ºæˆ‘çš„æ¨èç­‰çº§(ä»…è¯„è‡ªåˆ¶ç‰ˆï¼Œå…¶ä»–ä½œè€…çš„ä¸åšæ‰“åˆ†)ï¼Œæœ€å¤šä¸‰é¢—æ˜Ÿï¼›<br><br>â‘¢åç§°åé¢æ ‡æ³¨(æ’ä»¶)çš„è¡¨ç¤ºæ­¤å¿«æ·æŒ‡ä»¤æ¯”è¾ƒå»ºè®®æ­é… Opener Pro æˆ–è€… Click All In One è¿™ä¸¤ä¸ªå¿«æ·æŒ‡ä»¤ä½¿ç”¨ï¼›<br><br>â‘£ä»“è¾“å…¥æ³•ç›¸å…³å¿«æ·æŒ‡ä»¤ç”±äºå…·æœ‰ä¸€å®šç‰¹æ®Šæ€§åŠä¸Šæ‰‹éš¾åº¦ï¼Œå·²åœæ›´ï¼Œä¸æ¥å—Bugåé¦ˆä»¥åŠç–‘é—®è§£ç­”ï¼›<br><br>â‘¤å¦‚å¸Œæœ›æ¨èä½ è§‰å¾—å¥½ç”¨çš„å¿«æ·æŒ‡ä»¤æˆ–è€…åé¦ˆæˆ‘è‡ªåˆ¶éƒ¨åˆ†çš„Bugå¯é€šè¿‡ <a href="https://t.me/wwwengbot" target="_blank">Bot ç§ä¿¡</a>ã€‚
            </div>
            <div style="height: 6px;"></div>
          `;
          ul.appendChild(note);
        }

        updateTitleCount(shortcuts.length);
      }

      function filterList() {
        const input = document.getElementById("searchInput");
        const filter = input.value.toLowerCase();

        const authorValue = document.getElementById("authorFilter").value;
        const starValue = document.getElementById("starFilter").value;
        const timeValue = document.getElementById("timeFilter").value;

        let filtered = allShortcuts.filter(item =>
          item.title.toLowerCase().includes(filter)
        );

        if (authorValue) {
          filtered = filtered.filter(item => item.author === authorValue);
        }
        if (starValue) {
          filtered = filtered.filter(item => item.star >= parseInt(starValue));
        }

        if (timeValue === "asc") {
          filtered = filtered.sort((a, b) => (a.time || "").localeCompare(b.time || ""));
        } else if (timeValue === "desc") {
          filtered = filtered.sort((a, b) => (b.time || "").localeCompare(a.time || ""));
        }

        renderList(filtered);
      }

      async function loadShortcuts() {
        try {
          const response = await fetch("../files/shortcuts.json");
          allShortcuts = await response.json();

          // ç”Ÿæˆä½œè€…é€‰é¡¹
          const authorSet = new Set();
          allShortcuts.forEach(item => {
            if (item.author) authorSet.add(item.author);
          });

          const authorSelect = document.getElementById("authorFilter");
          [...authorSet].sort().forEach(author => {
            const opt = document.createElement("option");
            opt.value = author;
            opt.textContent = author;
            authorSelect.appendChild(opt);
          });

          // å…ˆæ¸²æŸ“åˆ—è¡¨
          filterList();

          // âœ… æ•°æ®åŠ è½½å®Œæˆåæ¸éšéšè—åŠ è½½åŠ¨ç”»
          const overlay = document.getElementById("loadingOverlay");
          if (overlay) {
            // ç¡®ä¿åŠ¨ç”»æ‰§è¡Œåœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼Œä¿è¯ DOM æ›´æ–°
            requestAnimationFrame(() => {
              overlay.style.transition = "opacity 0.3s ease"; // æ·»åŠ å¹³æ»‘è¿‡æ¸¡
              overlay.style.opacity = 0;
              setTimeout(() => {
                overlay.style.display = "none";
              }, 300); // 0.3s åå½»åº•éšè—
            });
          }

        } catch (e) {
          console.error("åŠ è½½å¿«æ·æŒ‡ä»¤å¤±è´¥ï¼š", e);
          // å‡ºé”™ä¹Ÿéšè—åŠ è½½åŠ¨ç”»é¿å…é®æŒ¡
          const overlay = document.getElementById("loadingOverlay");
          if (overlay) overlay.style.display = "none";
        }
      }

      function clearSearch() {
        const input = document.getElementById("searchInput");
        input.value = "";
        filterList();
        input.focus();
        document.getElementById("clearBtn").style.display = "none";
      }

      document.addEventListener("DOMContentLoaded", function () {
        loadShortcuts();
      });

      document.getElementById("searchInput").addEventListener("input", function () {
        document.getElementById("clearBtn").style.display = this.value.trim().length > 0 ? "block" : "none";
      });

      document.getElementById("searchInput").addEventListener("focus", function () {
        // ä»…åœ¨é iOS æ¡Œé¢æ¨¡å¼ä¸‹æ‰§è¡Œæ»šåŠ¨
        const isIOSStandalone = window.navigator.standalone === true;
        if (!isIOSStandalone) {
          this.scrollIntoView({ behavior: "smooth", block: "center" });
          setTimeout(() => {
            window.scrollBy({ top: -20, behavior: "smooth" });
          }, 200);
        }
      });

      document.getElementById("searchInput").addEventListener("keydown", function (e) {
        if (e.key === "Enter") this.blur();
      });

      ["authorFilter", "starFilter", "timeFilter"].forEach(id => {
        document.getElementById(id).addEventListener("change", filterList);
      });
    </script>

    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  </div>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('../files/service-worker.js')
          .then(reg => console.log('âœ… Service Worker æ³¨å†ŒæˆåŠŸ', reg))
          .catch(err => console.log('âŒ Service Worker æ³¨å†Œå¤±è´¥', err));
      });
    }
  </script>
  <script>
  // iOS PWA é”®ç›˜è¾“å…¥ä¿®å¤
  if (window.matchMedia('(display-mode: standalone)').matches) {
    document.body.addEventListener("focusin", () => {
      document.body.style.paddingBottom = "300px"; 
    });
    document.body.addEventListener("focusout", () => {
      document.body.style.paddingBottom = "0";
    });
  }
  </script>
  <script>
    // åˆ›å»ºåˆ·æ–°æŒ‰é’®
    const refreshBtn = document.createElement("button");
    refreshBtn.id = "refreshBtn";
    refreshBtn.title = "åˆ·æ–°é¡µé¢";
    refreshBtn.textContent = "âŸ³";
    refreshBtn.style.cssText = `
      position: fixed;
      right: 28px;
      bottom: 15px;
      z-index: 9999;
      width: 28px;
      height: 28px;
      border: none;
      border-radius: 50%;
      background: rgba(200, 200, 200, 0.15);
      color: rgba(50, 50, 50, 0.6);
      font-size: 1em;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      transition: all 0.25s ease, opacity 0.3s ease;
      opacity: 1;
    `;
    document.body.appendChild(refreshBtn);

    // hover æ•ˆæœ
    refreshBtn.addEventListener("mouseenter", () => {
      refreshBtn.style.background = "rgba(200, 200, 200, 0.25)";
      refreshBtn.style.color = "rgba(50, 50, 50, 0.9)";
      refreshBtn.style.transform = "scale(1.1)";
    });
    refreshBtn.addEventListener("mouseleave", () => {
      refreshBtn.style.background = "rgba(200, 200, 200, 0.15)";
      refreshBtn.style.color = "rgba(50, 50, 50, 0.6)";
      refreshBtn.style.transform = "scale(1)";
    });

    // ç‚¹å‡»åˆ·æ–°æŒ‰é’®
    refreshBtn.addEventListener("click", () => {
      const overlay = document.getElementById("loadingOverlay");
      if (overlay) overlay.style.display = "flex";

      setTimeout(() => {
        if (typeof loadShortcuts === "function") loadShortcuts();
        overlay.style.opacity = 1;
        const fadeOut = setInterval(() => {
          overlay.style.opacity -= 0.05;
          if (overlay.style.opacity <= 0) {
            overlay.style.display = "none";
            overlay.style.opacity = 1;
            clearInterval(fadeOut);
          }
        }, 16);
      }, 200);
    });

    // æ»šåŠ¨æ˜¾ç¤º/éšè—é€»è¾‘
    let scrollTimer;
    window.addEventListener("scroll", () => {
      refreshBtn.style.opacity = "0"; // æ»šåŠ¨æ—¶éšè—æŒ‰é’®
      clearTimeout(scrollTimer);
      scrollTimer = setTimeout(() => {
        refreshBtn.style.opacity = "1"; // åœæ­¢æ»šåŠ¨ 200ms åæ˜¾ç¤º
      }, 200); // 200ms åœæ­¢æ»šåŠ¨åæ˜¾ç¤ºï¼Œå¯è°ƒæ•´
    });
  </script>
  <script>
      overlay.style.display = "flex";
      overlay.style.opacity = "1"; // å­—ç¬¦ä¸²

      setTimeout(() => {
        const fadeOut = setInterval(() => {
          let opacity = parseFloat(overlay.style.opacity);
          opacity -= 0.05;
          if (opacity <= 0) {
            clearInterval(fadeOut);
            overlay.style.display = "none";
            overlay.style.opacity = "1"; // æ¢å¤åˆå§‹å€¼
          } else {
            overlay.style.opacity = opacity.toString();
          }
        }, 16);
      }, 200);
  </script>
</body>
</html>
